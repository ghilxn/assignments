```python

# Lab 4: Child Vaccination Chart
# Author: Gavin Alzghaier
# Goal: Use a nested dictionary with an insert() function to add patient records
#       without overwriting existing data.

# ---------- Global data structure ----------
# 'patient' is the main nested dictionary required by the lab.
# Keys:    record numbers (1, 2, 3, ...)
# Values:  dictionaries holding each patient's details
patient = {}

# We'll auto-increment this so every new patient gets a unique record number.
next_record_number = 1


def insert():
    """
    Ask the user for patient details and save them under a unique record number.
    Inputs:
        - Patient's first name (string)
        - Patient's last name  (string)
        - Birth month when the vaccine was administered (integer 1-12)
    Effect:
        - Updates the global 'patient' nested dictionary.
        - Increments the global 'next_record_number'.
    """
    global next_record_number  # so we can update the counter defined above

    print("\n--- Add a new patient ---")

    # Get first name
    first = input("Enter patient's first name: ").strip()

    # Get last name
    last = input("Enter patient's last name: ").strip()

    # Get the vaccine month as an integer from 1 to 12
    # I keep asking until the user gives a valid number.
    while True:
        month_text = input("Enter the birth month (1-12) when vaccine was given: ").strip()
        try:
            month = int(month_text)
            if 1 <= month <= 12:
                break
            else:
                print("Please enter a whole number from 1 to 12.")
        except ValueError:
            print("Please enter a valid whole number (e.g., 1, 2, ..., 12).")

    # Build the nested dictionary for this patient
    record = {
        "first_name": first,
        "last_name": last,
        "vaccine_month": month
    }

    # Save into the main dictionary under a new record number
    patient[next_record_number] = record

    # Confirmation + show exactly where it went
    print(f"\nSaved! Record #{next_record_number}: {patient[next_record_number]}")

    # Move to the next record number so we don't overwrite the previous one
    next_record_number += 1


def print_patient_db():
    """
    Pretty-print the entire patient dictionary so we can verify the data is there.
    """
    if not patient:
        print("\n(No patient records yet.)")
        return

    print("\n=== Current Patient Database ===")
    for rec_no, info in patient.items():
        print(f"Record #{rec_no}: "
              f"{info['first_name']} {info['last_name']} "
              f"(Vaccine Month: {info['vaccine_month']})")
    print(f"Total records: {len(patient)}")


def main():
    """
    Main loop:
      - Call insert() at least once.
      - Ask the user if they want to add another record.
      - Verify that multiple records exist without overwriting.
    """
    print("Child Vaccination Chart â€” Lab 4")
    print("This program stores child vaccine info in a nested dictionary.\n")

    # Call insert() at least once (lab requirement)
    insert()
    print_patient_db()  # Verification after the first insert

    # Ask if we want to add more patients
    while True:
        again = input("\nAdd another patient? (y/n): ").strip().lower()
        if again == "y":
            insert()
            print_patient_db()  # Verify after each insert
        elif again == "n":
            break
        else:
            print("Please type 'y' or 'n'.")

    print("\nThanks! Final database:")
    print_patient_db()


# Standard Python guard so the file can be imported without auto-running.
if __name__ == "__main__":
    main()

